# 📋 要件定義書：No.35「ジャーナリングアプリ」

**作成日**: 2025-01-13
**バージョン**: 1.0
**アプリ番号**: 35

---

## 1. プロジェクト概要

### 1.1 アプリ名
**ジャーナリングアプリ（Journaling App）**

### 1.2 目的・課題
- **解決したい課題**: 自己を見つめる、思考の整理
- **ターゲットユーザー**: 個人専用（一人だけが使う）
- **利用シーン**: 夜寝る前、朝起きた時、午前中、静かな空間
- **コンセプト**: シンプル + 分析機能（内省重視）

### 1.3 成功基準
- 思考が整理できる
- 自己理解が深まる
- AIとの対話が自然で役立つ
- 感情分析・振り返りが有益
- シンプルで使いやすい

---

## 2. 必須要件（中期以降の方針）

### 2.1 AI内蔵アプリケーション
- ✅ Google AI Studio API使用（31〜34番と同じ）
- ✅ **AIと会話する機能**（最重要）
- ✅ 内省の質問提案
- ✅ 日記の要約
- ✅ 感情分析
- ✅ 振り返りの提案

### 2.2 PWA標準実装
- ✅ オフライン対応
  - **記録・閲覧機能**: オフラインでも動作
  - **AI生成・会話**: オンライン必須
- ✅ インストール可能
- ✅ レスポンシブデザイン

### 2.3 既存アプリとの連携
- ✅ **17番「アファメーションアプリ」と連携可能性**
  - 元気が出る言葉をジャーナルに記録
  - アファメーション履歴との統合
- ✅ **19番「習慣トラッカー」と連携可能性**
  - 習慣の振り返りをジャーナルに記録
  - 習慣達成とジャーナル記録の相関分析

---

## 3. 機能仕様

### 3.1 コア機能

#### 3.1.1 記録機能
- **入力方法**:
  - プレーンテキスト入力（Markdownなし）
  - リッチテキストエディタ（太字、斜体程度）
  - 画像添付（おまけ機能）
- **日時管理**:
  - 完全自動保存（記録時の日時を自動記録）
  - 手動編集も可能（特殊な場合のみ）
- **タグ機能**:
  - 自由なタグ付け（カンマ区切り）
  - タグのオートコンプリート
- **カテゴリ機能**（おまけ程度）:
  - 仕事
  - プライベート
  - 学習
  - その他

#### 3.1.2 表示・閲覧機能
- **カレンダー表示**:
  - 月次カレンダービュー
  - 記録がある日にマーク表示
  - カレンダーから日付選択で記録表示
- **リスト表示**:
  - 時系列のリスト表示
  - 新しい順・古い順の切り替え
  - 各エントリーのプレビュー表示
- **検索機能**:
  - 全文検索（記録内容を全文検索）
  - タグ検索（特定タグの記録を抽出）
  - 日付検索（期間指定での検索）
- **フィルタリング**:
  - カテゴリでフィルタ
  - タグでフィルタ
  - 複数条件の組み合わせ

#### 3.1.3 AI機能（最重要・力を入れる）

##### 3.1.3.1 AIと会話する機能（必須）
- **会話形式**:
  - ジャーナルエントリーに対してAIと対話
  - 「この気持ちについてもっと話したい」とAIに相談
  - AIが質問を投げかけて内省を深める
- **会話履歴**:
  - 各エントリーに対する会話履歴を保存
  - 過去の会話を振り返り可能

##### 3.1.3.2 内省の質問提案
- **質問例**:
  - 「今日の良かったことは？」
  - 「今日学んだことは？」
  - 「明日やりたいことは？」
  - 「今の感情を3つの言葉で表すと？」
- **プロンプト生成**: ユーザーの記録内容に応じた質問を生成

##### 3.1.3.3 日記の要約
- **週次要約**: 1週間分の記録を要約
- **月次要約**: 1ヶ月分の記録を要約
- **テーマ抽出**: 繰り返し出てくるテーマを抽出

##### 3.1.3.4 感情分析（大事）
- **感情の可視化**:
  - ポジティブ/ネガティブの度合い
  - 主な感情（喜び、悲しみ、怒り、驚き、恐れ等）
- **感情の推移**:
  - 週次・月次での感情グラフ
  - 感情の変化パターンの分析

##### 3.1.3.5 振り返りの提案（大事）
- **定期的な振り返り**:
  - 週次振り返りの提案
  - 月次振り返りの提案
- **振り返り質問**:
  - 「この1週間で成長したことは？」
  - 「この1ヶ月で変わったことは？」
  - 「次の1週間で取り組みたいことは？」

##### 3.1.3.6 AI生成設定
- **生成タイミング**: 生成ボタンを押した時（手動トリガー）
- **キャッシュ**: 利用しない（毎回新しいコンテンツを生成）

### 3.2 データ管理

#### 3.2.1 保存
- **ローカルストレージ**: 全データをローカルに保存
- **容量制限**: ブラウザの制限内（IndexedDB使用で大容量対応）

#### 3.2.2 エクスポート
- **YAML形式**:
  - 構造化データとして出力
  - 他ツールでの再利用が容易
- **Markdown形式**:
  - 可読性の高いテキスト形式
  - Obsidian等のツールで読み込み可能

#### 3.2.3 インポート
- **Markdown形式**:
  - Obsidian等からのインポート
  - 日付・タグの自動抽出

#### 3.2.4 バックアップ
- **クラウドバックアップ**:
  - OneDriveへのバックアップ
  - Google Driveへのバックアップ
  - 手動トリガー（自動バックアップは将来拡張）

---

## 4. 非機能要件

### 4.1 デザイン要求
- **テーマ**: 温かみのある雰囲気
- **色使い**:
  - 温かみのある色（ベージュ、クリーム、オレンジ系）
  - 落ち着いたトーン
  - アクセントカラー: 優しいオレンジ・ピンク系
- **レイアウト**: ノート風デザイン
  - 紙のテクスチャ（控えめ）
  - 手書き風フォント（タイトル等）
  - ページめくりアニメーション（控えめ）
- **アニメーション**:
  - 控えめな遷移アニメーション
  - スムーズなページ切り替え
  - 書き込み時のフェードイン

### 4.2 パフォーマンス
- **読み込み速度**: 2秒以内
- **保存速度**: 即座（体感できないレベル）
- **検索速度**: 1秒以内（1000件まで）

### 4.3 互換性
- モダンブラウザ（Chrome, Edge, Safari, Firefox最新版）
- モバイル・タブレット対応
- PWAとしてインストール可能

---

## 5. 技術制約

### 5.1 使用API
- **Google AI Studio API**
  - モデル: Gemini Pro推奨
  - APIキー管理: ユーザー入力 + ローカルストレージ
  - 31〜34番と共通

### 5.2 データ保存
- **IndexedDB**
  - 大容量データ対応
  - 構造化データの保存
  - 高速な検索・フィルタ
- **LocalStorage**
  - 設定情報の保存
  - APIキーの保存

### 5.3 クラウド連携
- **OneDrive API**（バックアップ用）
- **Google Drive API**（バックアップ用）

---

## 6. 画面構成

### 6.1 メイン画面（記録画面）
```
┌─────────────────────────────────────┐
│  📖 ジャーナル                       │
├─────────────────────────────────────┤
│  [← カレンダー] [リスト →]          │
├─────────────────────────────────────┤
│  📅 2025年1月13日 (月) 20:30       │
│                                     │
│  ┌───────────────────────────────┐ │
│  │                               │ │
│  │  [テキスト入力エリア]          │ │
│  │  （ノート風のテクスチャ）       │ │
│  │                               │ │
│  │                               │ │
│  └───────────────────────────────┘ │
│                                     │
│  🏷️ タグ: [健康] [仕事] [+追加]   │
│  📂 カテゴリ: [プライベート ▼]     │
│  🖼️ [画像添付]                     │
│                                     │
│  [💾 保存]                          │
├─────────────────────────────────────┤
│  🤖 AI機能                          │
│  [✨ AIと会話] [📊 感情分析]       │
│  [📝 要約] [🔄 振り返り]           │
└─────────────────────────────────────┘
```

### 6.2 AIと会話画面
```
┌─────────────────────────────────────┐
│  🤖 AIとの会話                       │
├─────────────────────────────────────┤
│  【ジャーナルエントリー】            │
│  今日は仕事で大きな成果があった...   │
├─────────────────────────────────────┤
│  🤖 AI: その成果について、どんな     │
│       気持ちですか？                │
│                                     │
│  👤 あなた: すごく嬉しい！でも...    │
│                                     │
│  🤖 AI: 「でも」の後に何がありますか？│
│                                     │
│  ┌───────────────────────────────┐ │
│  │ [返信を入力...]                │ │
│  └───────────────────────────────┘ │
│  [送信]                             │
└─────────────────────────────────────┘
```

### 6.3 カレンダー画面
```
┌─────────────────────────────────────┐
│  📅 2025年1月                        │
├─────────────────────────────────────┤
│  日 月 火 水 木 金 土                │
│        1  2  3  4                   │
│  5  6  7  8  9 10 11                │
│ 12 ●13●14 15 16 17 18               │
│ 19 20 21 22 23 24 25                │
│ 26 27 28 29 30 31                   │
│                                     │
│  ● = 記録あり                       │
├─────────────────────────────────────┤
│  [選択日の記録一覧]                  │
│  ━━━━━━━━━━━━━━━                 │
│  📖 13日 20:30                      │
│  今日は仕事で大きな成果が...         │
│                                     │
│  📖 13日 08:00                      │
│  朝から気分が良い...                 │
└─────────────────────────────────────┘
```

### 6.4 リスト画面
```
┌─────────────────────────────────────┐
│  📋 記録リスト                       │
├─────────────────────────────────────┤
│  [🔍 検索] [🏷️ タグ] [📂 カテゴリ]│
│  [新しい順 ▼]                       │
├─────────────────────────────────────┤
│  ━━━━━━━━━━━━━━━                 │
│  📖 2025/01/13 20:30               │
│  今日は仕事で大きな成果が...         │
│  🏷️ 仕事, 達成感                   │
│  ━━━━━━━━━━━━━━━                 │
│  📖 2025/01/13 08:00               │
│  朝から気分が良い...                 │
│  🏷️ 健康, 気分                     │
│  ━━━━━━━━━━━━━━━                 │
│  📖 2025/01/12 21:00               │
│  今日は少し疲れた...                 │
│  🏷️ 健康                           │
└─────────────────────────────────────┘
```

### 6.5 感情分析画面
```
┌─────────────────────────────────────┐
│  📊 感情分析                         │
├─────────────────────────────────────┤
│  📅 2025年1月（月次）               │
│                                     │
│  【感情の推移】                      │
│  ポジティブ ━━━━●━━━━━━━ 70%     │
│  ネガティブ ━●━━━━━━━━━━ 30%     │
│                                     │
│  【主な感情】                        │
│  😊 喜び     45%                    │
│  😌 安心     25%                    │
│  😕 不安     20%                    │
│  😠 怒り     10%                    │
│                                     │
│  【グラフ】                          │
│  [週次の感情変化グラフ]              │
│                                     │
│  🤖 AIコメント:                     │
│  この1ヶ月は全体的にポジティブな...   │
└─────────────────────────────────────┘
```

### 6.6 設定画面
```
┌─────────────────────────────────────┐
│  ⚙️ 設定                            │
├─────────────────────────────────────┤
│  🔑 APIキー設定                     │
│  [Google AI Studio APIキー入力]    │
│                                     │
│  💾 データ管理                       │
│  [📤 エクスポート (YAML/Markdown)] │
│  [📥 インポート (Markdown)]        │
│  [☁️ クラウドバックアップ]         │
│  [🗑️ データクリア]                 │
│                                     │
│  🎨 テーマ設定                       │
│  [ノートの色] [フォント]            │
│                                     │
│  ℹ️ アプリ情報                      │
│  バージョン: 1.0                    │
└─────────────────────────────────────┘
```

---

## 7. 開発スコープ外（将来拡張）

- 複数ユーザー対応
- リアルタイム同期（複数デバイス間）
- 音声入力
- 手書き入力（タッチペン対応）
- 17番「アファメーションアプリ」との本格統合
- 19番「習慣トラッカー」との本格統合
- AIによる自動質問（プッシュ通知）
- 感情グラフの高度な分析（機械学習）
- Markdownエディタ対応

---

## 8. リスクと対策

### 8.1 技術リスク
| リスク | 対策 |
|--------|------|
| IndexedDBの容量制限 | 古いデータの圧縮、エクスポート推奨 |
| AI会話の遅延 | ローディング表示、タイムアウト設定 |
| クラウドバックアップの認証 | OAuth 2.0使用、明確な説明 |
| 検索パフォーマンス | インデックス最適化、部分一致の制限 |

### 8.2 運用リスク
| リスク | 対策 |
|--------|------|
| APIキー未設定時のUX | デモモード・プレースホルダー表示 |
| データ消失リスク | 定期的なエクスポート推奨、バックアップ機能 |

---

## 9. 既存アプリとの連携

### 9.1 連携対象（将来拡張）
- **17番「アファメーションアプリ」**
  - アファメーションをジャーナルに記録
  - ジャーナルの内容に基づくアファメーション提案
- **19番「習慣トラッカー」**
  - 習慣の達成状況をジャーナルに自動記録
  - ジャーナルの内容から習慣の定着度を分析

---

## 10. ジャーナリング用語集

| 用語 | 意味 |
|------|------|
| ジャーナリング | 日記・記録を通じて自己を見つめる行為 |
| 内省 | 自分の内面を深く見つめること |
| 感情分析 | 記録内容から感情を分析すること |
| 振り返り | 過去の記録を見て学びを得ること |
| エントリー | 1つの記録単位 |

---

## 11. 次ステップ

1. ✅ 要件定義書レビュー・承認
2. ⬜ 技術設計書作成
3. ⬜ 実装計画書作成
4. ⬜ 実装開始（Claude Code on the Web）

---

**作成者**: クロ
**レビュー待ち**: あおいさん
